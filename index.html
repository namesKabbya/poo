<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Healthy Finance Tracker</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root {
  --bg: #020617;
  --card: rgba(30,41,59,0.92);
  --accent: #38bdf8;
  --green: #22c55e;
  --red: #ef4444;
  --text: #e5e7eb;
}

body {
  margin: 0;
  padding: 20px;
  font-family: system-ui, sans-serif;
  background: linear-gradient(145deg, #020617, #0f172a);
  color: var(--text);
}

h1 { text-align: center; margin-bottom: 22px; }

.container {
  max-width: 560px;
  margin: auto;
}

section {
  background: var(--card);
  backdrop-filter: blur(10px);
  padding: 16px;
  margin-bottom: 18px;
  border-radius: 18px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.35);
}

button {
  width: 100%;
  background: var(--accent);
  color: #000;
  border: none;
  padding: 10px;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
  margin-top: 8px;
}

input, select {
  width: 100%;
  padding: 10px;
  margin-top: 6px;
  border-radius: 10px;
  border: none;
  background: #020617;
  color: var(--text);
}

.progress {
  height: 14px;
  background: #1e293b;
  border-radius: 10px;
  overflow: hidden;
}

.progress span {
  display: block;
  height: 100%;
  width: 0%;
  background: var(--green);
  transition: width 0.3s ease;
}

ul {
  padding-left: 18px;
  margin: 10px 0;
}

canvas {
  margin-top: 14px;
  height: 280px !important;
}
</style>
</head>

<body>

<h1>ðŸ’¸ Healthy Finance Tracker</h1>

<div class="container">

<section>
  <h2>ðŸ’§ Water</h2>
  <p><span id="water">0</span> / 8 glasses</p>
  <div class="progress"><span id="waterBar"></span></div>
  <button onclick="drink()">Drink Water</button>
</section>

<section>
  <h2>ðŸ’° Savings</h2>
  <input id="saveAmt" type="number" placeholder="Amount">
  <button onclick="save()">Add Savings</button>
  <p>Total Saved: à§³<strong id="saved">0</strong></p>
</section>

<section>
  <h2>ðŸ“Š Expenses</h2>
  <input id="expAmt" type="number" placeholder="Expense amount">
  <select id="cat">
    <option>Food</option>
    <option>Transport</option>
    <option>Shopping</option>
    <option>Other</option>
  </select>
  <button onclick="expense()">Add Expense</button>

  <ul id="expList"></ul>

  <canvas id="pieChart"></canvas>
  <canvas id="barChart"></canvas>

  <button onclick="exportCSV()">â¬‡ Export CSV</button>
</section>

</div>

<script>
/* ---------- STATE ---------- */
let water = Number(localStorage.getItem("water")) || 0;
let saved = Number(localStorage.getItem("saved")) || 0;
let expenses = JSON.parse(localStorage.getItem("expenses")) || {};
let monthly = JSON.parse(localStorage.getItem("monthly")) || [];
let pieChart = null;
let barChart = null;

/* ---------- DOM ---------- */
const waterText = document.getElementById("water");
const waterBar = document.getElementById("waterBar");
const savedText = document.getElementById("saved");
const expList = document.getElementById("expList");
const pieChartEl = document.getElementById("pieChart");
const barChartEl = document.getElementById("barChart");

/* ---------- INIT ---------- */
updateWater();
savedText.innerText = saved;
renderList();
drawCharts();
dailyReset();

/* ---------- WATER ---------- */
function drink() {
  if (water < 8) {
    water++;
    localStorage.setItem("water", water);
    updateWater();
  }
}

function updateWater() {
  waterText.innerText = water;
  waterBar.style.width = (water / 8) * 100 + "%";
}

/* ---------- SAVINGS ---------- */
function save() {
  const amt = Number(document.getElementById("saveAmt").value);
  if (!amt || amt <= 0) return;

  saved += amt;
  localStorage.setItem("saved", saved);
  savedText.innerText = saved;
  document.getElementById("saveAmt").value = "";
}

/* ---------- EXPENSES ---------- */
function expense() {
  const amt = Number(document.getElementById("expAmt").value);
  const catVal = document.getElementById("cat").value;

  if (!amt || amt <= 0) return;

  expenses[catVal] = (expenses[catVal] || 0) + amt;
  monthly.push({ date: new Date().toLocaleDateString(), amt });

  localStorage.setItem("expenses", JSON.stringify(expenses));
  localStorage.setItem("monthly", JSON.stringify(monthly));

  document.getElementById("expAmt").value = "";
  renderList();
  drawCharts();
}

function renderList() {
  expList.innerHTML = "";
  for (const key in expenses) {
    expList.innerHTML += `<li>${key}: à§³${expenses[key]}</li>`;
  }
}

/* ---------- CHARTS ---------- */
function drawCharts() {
  if (pieChart) pieChart.destroy();
  if (barChart) barChart.destroy();

  pieChart = new Chart(pieChartEl, {
    type: "pie",
    data: {
      labels: Object.keys(expenses),
      datasets: [{
        data: Object.values(expenses),
        backgroundColor: ["#fb923c","#22c55e","#60a5fa","#a78bfa"]
      }]
    }
  });

  const days = {};
  monthly.forEach(e => {
    days[e.date] = (days[e.date] || 0) + e.amt;
  });

  barChart = new Chart(barChartEl, {
    type: "bar",
    data: {
      labels: Object.keys(days),
      datasets: [{
        data: Object.values(days)
      }]
    }
  });
}

/* ---------- EXPORT ---------- */
function exportCSV() {
  let csv = "Category,Amount\n";
  for (const k in expenses) {
    csv += `${k},${expenses[k]}\n`;
  }
  const blob = new Blob([csv], { type: "text/csv" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "expenses.csv";
  a.click();
}

/* ---------- RESET ---------- */
function dailyReset() {
  const today = new Date().toDateString();
  if (localStorage.getItem("day") !== today) {
    localStorage.setItem("day", today);
    water = 0;
    localStorage.setItem("water", 0);
    updateWater();
  }
}
</script>

</body>
</html>
